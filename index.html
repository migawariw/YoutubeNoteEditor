<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>note風エディタ</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #f6f6f6;
      padding: 40px;
    }

    .editor {
      max-width: 720px;
      margin: auto;
      background: white;
      padding: 24px;
      border-radius: 8px;
      line-height: 1.8;
    }

    .editor h1 {
      font-size: 28px;
      margin: 1.5em 0 0.5em;
    }

    .editor h2 {
      font-size: 22px;
      margin: 1.5em 0 0.5em;
    }

    .editor img {
      max-width: 100%;
      border-radius: 6px;
      margin: 16px 0;
    }

    .editor iframe {
      width: 100%;
      aspect-ratio: 16 / 9;
      border-radius: 6px;
      margin: 16px 0;
    }
  </style>
</head>
<body>

<div class="editor" contenteditable="true" id="editor">
  <h1></h1>
  <p></p>
  <p></p>
</div>

<script>
const editor = document.getElementById("editor");

editor.addEventListener("paste", (e) => {
  const text = e.clipboardData.getData("text");

  const match = text.match(
    /https?:\/\/(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/)([\w-]+)/
  );

  if (!match) return;

  e.preventDefault(); // 通常の貼り付けを止める

  const videoId = match[1];
  insertYouTube(videoId);
});

function insertYouTube(videoId) {
  const iframe = document.createElement("iframe");
  iframe.src = `https://www.youtube.com/embed/${videoId}`;
  iframe.allowFullscreen = true;
  iframe.style.width = "100%";
  iframe.style.aspectRatio = "16 / 9";
  iframe.style.borderRadius = "6px";
  iframe.style.margin = "16px 0";

  const range = window.getSelection().getRangeAt(0);
  range.deleteContents();

  const wrapper = document.createElement("div");
  wrapper.contentEditable = "false"; // ★超重要
  wrapper.appendChild(iframe);

  range.insertNode(wrapper);

  // カーソルを次の行へ
  range.setStartAfter(wrapper);
  range.collapse(true);
}
</script>



</body>
</html>
